<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏ô‡∏±‡∏Å‡∏õ‡∏£‡∏∏‡∏á‡∏™‡∏°‡∏Å‡∏≤‡∏£ (‡∏â‡∏ö‡∏±‡∏ö‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå)</title>
    <style>
        /* ‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤‡∏ü‡∏≠‡∏ô‡∏ï‡πå‡∏™‡∏ß‡∏¢‡πÜ ‡∏à‡∏≤‡∏Å Google Fonts */
        @import url('https://fonts.googleapis.com/css2?family=Kanit:wght@300;600&display=swap');

        body {
            font-family: 'Kanit', sans-serif;
            background-color: #2c3e50;
            color: white;
            text-align: center;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            user-select: none; /* ‡∏´‡πâ‡∏≤‡∏°‡∏Ñ‡∏•‡∏∏‡∏°‡∏î‡∏≥ */
        }

        h1 { margin-top: 20px; color: #f1c40f; }

        .game-container {
            background: rgba(255, 255, 255, 0.1);
            padding: 30px;
            border-radius: 20px;
            width: 90%;
            max-width: 600px;
            margin-top: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        /* ‡∏™‡πà‡∏ß‡∏ô‡πÅ‡∏™‡∏î‡∏á‡πÇ‡∏à‡∏ó‡∏¢‡πå‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢ */
        .target-box {
            font-size: 50px;
            background: #e74c3c;
            padding: 10px 40px;
            border-radius: 15px;
            display: inline-block;
            margin-bottom: 30px;
            box-shadow: 0 5px 0 #c0392b;
            font-weight: bold;
            animation: pulse 2s infinite;
        }

        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.05); } 100% { transform: scale(1); } }

        /* ‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ß‡∏≤‡∏á‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö (Equation Slots) */
        .equation-area {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
            margin-bottom: 40px;
            flex-wrap: wrap; /* ‡πÄ‡∏ú‡∏∑‡πà‡∏≠‡∏à‡∏≠‡πÄ‡∏•‡πá‡∏Å */
        }

        .slot {
            width: 80px;
            height: 80px;
            background-color: #ecf0f1;
            border: 4px dashed #95a5a6;
            border-radius: 10px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 32px;
            color: #2c3e50;
            font-weight: bold;
            transition: all 0.2s;
        }

        /* ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏°‡∏µ‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏ä‡πà‡∏≠‡∏á */
        .slot.filled {
            border-style: solid;
            border-color: #2ecc71;
            background-color: #fff;
            cursor: pointer; /* ‡πÄ‡∏°‡∏≤‡∏™‡πå‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏π‡∏õ‡∏°‡∏∑‡∏≠ */
            box-shadow: 0 4px 0 #bdc3c7;
        }

        /* ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏≠‡∏≤‡πÄ‡∏°‡∏≤‡∏™‡πå‡∏ä‡∏µ‡πâ‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç (‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏•‡∏ö) */
        .slot.filled:hover {
            background-color: #ffcccc;
            border-color: #e74c3c;
            transform: scale(1.05);
        }

        .equals-sign { font-size: 40px; margin: 0 5px; }

        /* ‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÉ‡∏´‡πâ‡∏•‡∏≤‡∏Å (Inventory) */
        .options-area {
            background: white;
            padding: 20px;
            border-radius: 15px;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 15px;
            min-height: 80px;
        }

        .draggable-item {
            width: 60px;
            height: 60px;
            background: #3498db;
            color: white;
            border-radius: 10px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 28px;
            font-weight: bold;
            cursor: grab;
            box-shadow: 0 4px 0 #2980b9;
            transition: transform 0.1s;
        }

        .draggable-item:active { cursor: grabbing; transform: scale(0.9); }
        .draggable-item[data-type="operator"] { background: #9b59b6; box-shadow: 0 4px 0 #8e44ad; }

        /* ‡∏õ‡∏∏‡πà‡∏°‡πÅ‡∏•‡∏∞ Feedback */
        .btn-check {
            margin-top: 30px;
            padding: 15px 40px;
            font-size: 24px;
            background-color: #27ae60;
            color: white;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            box-shadow: 0 5px 0 #219150;
            font-family: 'Kanit', sans-serif;
            transition: transform 0.1s;
        }
        
        .btn-check:active { transform: translateY(4px); box-shadow: none; }

        .score-board { font-size: 20px; margin-bottom: 10px; color: #ecf0f1; }
        
        /* ‡πÄ‡∏≠‡∏ü‡πÄ‡∏ü‡∏Å‡∏ï‡πå‡∏ï‡∏≠‡∏ö‡∏ñ‡∏π‡∏Å/‡∏ú‡∏¥‡∏î */
        .correct-bg { background-color: #27ae60 !important; color: white !important; border-color: #2ecc71 !important; }
        .wrong-bg { animation: shake 0.5s; background-color: #c0392b !important; color: white !important; border-color: #e74c3c !important; }

        @keyframes shake {
            0% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            50% { transform: translateX(10px); }
            75% { transform: translateX(-10px); }
            100% { transform: translateX(0); }
        }
    </style>
</head>
<body>

    <h1>üßÆ ‡∏ô‡∏±‡∏Å‡∏õ‡∏£‡∏∏‡∏á‡∏™‡∏°‡∏Å‡∏≤‡∏£</h1>
    <div class="score-board">‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô: <span id="score">0</span></div>

    <div class="game-container">
        <div>‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÑ‡∏î‡πâ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå:</div>
        <div id="target-number" class="target-box">?</div>

        <div class="equation-area">
            <div class="slot" id="slot-1" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
            <div class="slot" id="slot-op" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
            <div class="slot" id="slot-2" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
            <div class="equals-sign">=</div>
            <div id="target-display" style="font-size: 32px; font-weight: bold;">?</div>
        </div>

        <p>‡∏•‡∏≤‡∏Å‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡πÅ‡∏•‡∏∞‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏´‡∏°‡∏≤‡∏¢‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á üëá (‡∏Ñ‡∏•‡∏¥‡∏Å‡πÉ‡∏ô‡∏ä‡πà‡∏≠‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏•‡∏ö‡∏≠‡∏≠‡∏Å)</p>
        <div class="options-area" id="options-container">
            </div>

        <button class="btn-check" onclick="checkAnswer()">‡∏ï‡∏£‡∏ß‡∏à‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö ‚úÖ</button>
    </div>

    <script>
        // --- Game Logic ---
        
        let currentTarget = 0;
        let score = 0;
        
        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏î‡πà‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà
        function generateLevel() {
            // ‡∏™‡∏∏‡πà‡∏°‡πÄ‡∏•‡∏Ç 1-9
            const num1 = Math.floor(Math.random() * 9) + 1; 
            const num2 = Math.floor(Math.random() * 9) + 1; 
            
            // ‡∏™‡∏∏‡πà‡∏°‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏´‡∏°‡∏≤‡∏¢
            const operators = ['+', '-', '*']; 
            const selectedOp = operators[Math.floor(Math.random() * operators.length)];

            // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö
            let result;
            if (selectedOp === '+') result = num1 + num2;
            else if (selectedOp === '-') result = num1 - num2;
            else if (selectedOp === '*') result = num1 * num2;

            // ‡∏ñ‡πâ‡∏≤‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏ï‡∏¥‡∏î‡∏•‡∏ö ‡πÉ‡∏´‡πâ‡∏™‡∏∏‡πà‡∏°‡πÉ‡∏´‡∏°‡πà (‡πÄ‡∏î‡πá‡∏Å‡∏à‡∏∞‡πÑ‡∏î‡πâ‡πÑ‡∏°‡πà‡∏á‡∏á)
            if (result < 0) {
                generateLevel(); 
                return;
            }

            currentTarget = result;
            
            // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠
            document.getElementById('target-number').innerText = currentTarget;
            document.getElementById('target-display').innerText = currentTarget;
            
            clearSlots(); // ‡∏•‡πâ‡∏≤‡∏á‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏ô‡πÄ‡∏Å‡πà‡∏≤

            // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å (Array)
            let options = [];
            // ‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å
            options.push({ val: num1, type: 'number' });
            options.push({ val: num2, type: 'number' });
            options.push({ val: selectedOp, type: 'operator' });

            // ‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏•‡∏≠‡∏Å (Decoy)
            options.push({ val: Math.floor(Math.random() * 9) + 1, type: 'number' });
            options.push({ val: Math.floor(Math.random() * 9) + 1, type: 'number' });
            // ‡∏™‡∏∏‡πà‡∏°‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏´‡∏°‡∏≤‡∏¢‡∏´‡∏•‡∏≠‡∏Å‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏ã‡πâ‡∏≥‡∏Å‡∏±‡∏ö‡∏ï‡∏±‡∏ß‡∏ñ‡∏π‡∏Å
            const decoyOp = operators.filter(o => o !== selectedOp)[0];
            options.push({ val: decoyOp, type: 'operator' });

            // ‡∏™‡∏•‡∏±‡∏ö‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å (Shuffle)
            options.sort(() => Math.random() - 0.5);

            // ‡∏ß‡∏≤‡∏î‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏•‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠
            const container = document.getElementById('options-container');
            container.innerHTML = '';
            
            options.forEach((item, index) => {
                const el = document.createElement('div');
                el.classList.add('draggable-item');
                el.innerText = item.val;
                el.draggable = true;
                el.id = 'drag-' + index;
                el.dataset.val = item.val;
                el.dataset.type = item.type;
                
                // Event ‡∏ï‡∏≠‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏•‡∏≤‡∏Å
                el.ondragstart = (e) => {
                    e.dataTransfer.setData("text", e.target.id);
                    e.dataTransfer.setData("val", item.val);
                    e.dataTransfer.setData("type", item.type);
                };

                container.appendChild(el);
            });
        }

        // --- ‡∏£‡∏∞‡∏ö‡∏ö Drag & Drop ‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏î‡∏∂‡∏á‡∏≠‡∏≠‡∏Å (Core Fixes) ---

        function allowDrop(ev) {
            ev.preventDefault();
        }

        function drop(ev) {
            ev.preventDefault();
            const sourceId = ev.dataTransfer.getData("text");
            const val = ev.dataTransfer.getData("val");
            const type = ev.dataTransfer.getData("type");
            
            const draggedElement = document.getElementById(sourceId);
            const dropZone = ev.target;

            // ‡πÄ‡∏ä‡πá‡∏Ñ‡∏ß‡πà‡∏≤‡∏•‡∏≤‡∏Å‡∏°‡∏≤‡πÉ‡∏™‡πà‡∏ñ‡∏π‡∏Å‡∏ä‡πà‡∏≠‡∏á‡πÑ‡∏´‡∏° (‡πÄ‡∏•‡∏Ç->‡∏ä‡πà‡∏≠‡∏á‡πÄ‡∏•‡∏Ç, ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏´‡∏°‡∏≤‡∏¢->‡∏ä‡πà‡∏≠‡∏á‡∏Å‡∏•‡∏≤‡∏á)
            let isValidZone = false;
            if (dropZone.id === 'slot-op' && type === 'operator') isValidZone = true;
            if ((dropZone.id === 'slot-1' || dropZone.id === 'slot-2') && type === 'number') isValidZone = true;

            if (isValidZone) {
                // FIX 1: ‡∏ñ‡πâ‡∏≤‡∏ä‡πà‡∏≠‡∏á‡∏ô‡∏µ‡πâ‡∏°‡∏µ‡∏Ç‡∏≠‡∏á‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß ‡πÉ‡∏´‡πâ‡∏î‡∏µ‡∏î‡∏ï‡∏±‡∏ß‡πÄ‡∏Å‡πà‡∏≤‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏Å‡πà‡∏≠‡∏ô (Swap)
                if (dropZone.classList.contains('filled')) {
                    returnItemToInventory(dropZone);
                }

                // ‡πÄ‡∏≠‡∏≤‡∏ï‡∏±‡∏ß‡πÉ‡∏´‡∏°‡πà‡πÉ‡∏™‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ
                dropZone.innerText = val;
                dropZone.dataset.value = val;
                dropZone.dataset.sourceId = sourceId; // ‡∏à‡∏≥‡∏ß‡πà‡∏≤‡∏°‡∏≤‡∏à‡∏≤‡∏Å ID ‡πÑ‡∏´‡∏ô
                dropZone.classList.add('filled');
                
                // ‡∏ã‡πà‡∏≠‡∏ô‡∏ï‡∏±‡∏ß‡∏ï‡πâ‡∏ô‡∏ó‡∏≤‡∏á (Inventory)
                if(draggedElement) draggedElement.style.visibility = 'hidden';
                
                // FIX 2: ‡∏™‡∏£‡πâ‡∏≤‡∏á Event ‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏•‡∏ö‡∏≠‡∏≠‡∏Å (Click to remove)
                dropZone.onclick = function() {
                    returnItemToInventory(this);
                };
            }
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ä‡πà‡∏ß‡∏¢: ‡∏Ñ‡∏∑‡∏ô‡∏Ñ‡πà‡∏≤‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á
        function returnItemToInventory(slotElement) {
            const sourceId = slotElement.dataset.sourceId;
            
            if (sourceId) {
                const sourceElement = document.getElementById(sourceId);
                if (sourceElement) {
                    sourceElement.style.visibility = 'visible'; // ‡πÅ‡∏™‡∏î‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏î‡∏¥‡∏°‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤
                }
            }

            // ‡∏•‡πâ‡∏≤‡∏á‡∏Ñ‡πà‡∏≤‡πÉ‡∏ô‡∏ä‡πà‡∏≠‡∏á
            slotElement.innerText = '';
            slotElement.classList.remove('filled', 'correct-bg', 'wrong-bg');
            delete slotElement.dataset.value;
            delete slotElement.dataset.sourceId;
            
            // ‡πÄ‡∏≠‡∏≤ Event ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏≠‡∏≠‡∏Å
            slotElement.onclick = null; 
        }

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ä‡πà‡∏ß‡∏¢: ‡∏•‡πâ‡∏≤‡∏á‡∏ó‡∏∏‡∏Å‡∏ä‡πà‡∏≠‡∏á (‡πÉ‡∏ä‡πâ‡∏ï‡∏≠‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏î‡πà‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà)
        function clearSlots() {
            ['slot-1', 'slot-op', 'slot-2'].forEach(id => {
                const el = document.getElementById(id);
                // ‡πÉ‡∏ä‡πâ returnItemToInventory ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏±‡∏ß‡∏£‡πå‡∏ß‡πà‡∏≤‡∏Ç‡∏≠‡∏á‡∏à‡∏∞‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡πÄ‡∏î‡∏¥‡∏°‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡∏Ñ‡πâ‡∏≤‡∏á‡∏≠‡∏¢‡∏π‡πà
                returnItemToInventory(el);
            });
        }

        // --- ‡∏ï‡∏£‡∏ß‡∏à‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö ---
        function checkAnswer() {
            const v1 = document.getElementById('slot-1').dataset.value;
            const op = document.getElementById('slot-op').dataset.value;
            const v2 = document.getElementById('slot-2').dataset.value;

            if (!v1 || !op || !v2) {
                alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏ï‡∏¥‡∏°‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ó‡∏∏‡∏Å‡∏ä‡πà‡∏≠‡∏á‡∏Å‡πà‡∏≠‡∏ô‡∏ô‡∏∞‡∏Ñ‡∏£‡∏±‡∏ö!");
                return;
            }

            let userResult = 0;
            const num1 = parseInt(v1);
            const num2 = parseInt(v2);

            if (op === '+') userResult = num1 + num2;
            else if (op === '-') userResult = num1 - num2;
            else if (op === '*') userResult = num1 * num2;

            if (userResult === currentTarget) {
                // ‡∏ï‡∏≠‡∏ö‡∏ñ‡∏π‡∏Å
                score += 10;
                document.getElementById('score').innerText = score;
                // ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏µ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß
                document.querySelectorAll('.slot').forEach(s => s.classList.add('correct-bg'));
                
                setTimeout(() => {
                    alert("‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á! üéâ ‡πÄ‡∏Å‡πà‡∏á‡∏°‡∏≤‡∏Å");
                    generateLevel(); // ‡πÑ‡∏õ‡∏î‡πà‡∏≤‡∏ô‡∏ï‡πà‡∏≠‡πÑ‡∏õ
                }, 500);
            } else {
                // ‡∏ï‡∏≠‡∏ö‡∏ú‡∏¥‡∏î
                // ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏µ‡πÅ‡∏î‡∏á‡πÅ‡∏•‡∏∞‡∏™‡∏±‡πà‡∏ô
                document.querySelectorAll('.slot').forEach(s => s.classList.add('wrong-bg'));
                setTimeout(() => {
                    document.querySelectorAll('.slot').forEach(s => s.classList.remove('wrong-bg'));
                }, 500);
            }
        }

        // ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏Å‡∏°‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÅ‡∏£‡∏Å
        generateLevel();

    </script>
</body>
</html>